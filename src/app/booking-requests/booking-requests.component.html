
<h2 class="page-title container" style="text-align: left; padding-left: 170px;">การจองของฉัน</h2>
<div class="container table-wrap">
  <table class="table">
    <thead><tr><th>#</th><th>หอ</th><th>ช่วง</th><th>สถานะ</th><th>ราคารวม</th><th>จัดการ</th></tr></thead>
    <tbody>
      @for (b of list; track b.id) {
        <tr>
          <td>{{ $index + 1 }}</td>
          <td>{{ b.listingId }}</td>
          <td>{{ b.startDate }} – {{ b.endDate }}</td>
          <td>
            <span class="badge" [class.status-approved]="b.status==='approved'" [class.status-rejected]="b.status==='rejected'" [class.status-cancelled]="b.status==='cancelled'">{{ b.status }}</span>
          </td>
          <td></td>
          <td class="row-actions">
            <button class="btn btn-outline" (click)="startEdit(b)" [disabled]="editingId === b.id">แก้ไข</button>
            <button class="btn btn-outline" (click)="remove(b.id)">ลบ</button>
          </td>
        </tr>
        @if (editingId === b.id) {
          <tr>
            <td colspan="6">
              <form (ngSubmit)="saveEdit()" style="display:flex; gap:8px; align-items:center;">
                <input type="date" [(ngModel)]="editStart" name="editStart" required />
                <input type="date" [(ngModel)]="editEnd" name="editEnd" required />
                <input type="text" [(ngModel)]="editNotes" name="editNotes" placeholder="หมายเหตุ" />
                <button type="submit" class="btn">บันทึก</button>
                <button type="button" class="btn btn-outline" (click)="cancel()">ยกเลิก</button>
              </form>
            </td>
          </tr>
        }
      }
    </tbody>
  </table>
</div>
@if (message) { <div class="alert container" style="margin-top:10px;">{{ message }}</div> }
